#!/usr/bin/make -f
export DH_VERBOSE = 1
export DEB_BUILD_MAINT_OPTIONS = hardening=+all
export CPPFLAGS     :=$(shell dpkg-buildflags --get CPPFLAGS)
export CFLAGS       :=$(shell dpkg-buildflags --get CFLAGS) $(CPPFLAGS)
export CXXFLAGS     := $(shell dpkg-buildflags --get CXXFLAGS) $(CPPFLAGS)
export DEB_CFLAGS_MAINT_APPEND   = -std=c++14
export DEB_CPPFLAGS_MAINT_APPEND = -std=c++14
export DEB_CXXFLAGS_MAINT_APPEND = -std=c++14
export LDFLAGS      :=$(shell dpkg-buildflags --get LDFLAGS)
export RDBASE       := $(CURDIR)
export DEB_BUILD_OPTIONS="parallel=10"

%:
	dh $@ --buildsystem=cmake --parallel

override_dh_auto_configure:
	dh_auto_configure -- \
                -DCMAKE_SKIP_RPATH:BOOL=ON \
                -DRDK_INSTALL_INTREE=OFF \
                -DRDK_BUILD_PYTHON_WRAPPERS=OFF \
                -DPYTHON_NUMPY_INCLUDE_PATH="$(python -c 'import numpy ; print(numpy.get_include())')" \
                -DRDK_OPTIMIZE_POPCNT=OFF \
                -DRDK_BUILD_THREADSAFE_SSS=ON \
                -DRDK_INSTALL_COMIC_FONTS=OFF \
                -DRDK_BUILD_FREETYPE_SUPPORT=OFF \
                -DRDK_INSTALL_STATIC_LIBS=ON \
                -DRDK_BUILD_SWIG_JAVA_WRAPPER=OFF \
                -DRDK_BUILD_CPP_TESTS=OFF  \
                -DBOOST_ROOT=/usr/include/boost \
                -DRDK_BUILD_CAIRO_SUPPORT=OFF \
                -DRDK_BUILD_INCHI_SUPPORT=OFF \
                -DRDK_BUILD_AVALON_SUPPORT=OFF \
                -DCMAKE_INSTALL_PREFIX=/usr \
                -DCMAKE_LIBRARY_ARCHITECTURE="$(DEB_TARGET_MULTIARCH)"


